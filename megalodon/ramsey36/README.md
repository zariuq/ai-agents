# R(3,6) = 18 Formalization in Megalodon

## Overview

This directory contains a formalization of the Ramsey number R(3,6) = 18 in the Megalodon theorem prover for Proofgold.

## Verification Status

| Theorem | Status | Notes |
|---------|--------|-------|
| `Adj17_sym` | **Kernel verified** | 2.8s, 2572 lines |
| `neq_lemmas` (10-16) | **Kernel verified** | Extends preamble |
| `Adj17_not_i_j` (190 non-edges) | **Kernel verified** | ~11s, all non-edge proofs |
| `Adj17_not_i_i` (17 self-loops) | **Kernel verified** | Generated with --with-self-loops |
| `Adj17_path_i_j_k` (316 paths) | **Kernel verified** | Triangle-free witnesses |
| `tf_x_y_z` (4913 cases) | **Kernel verified** | Individual triangle-free cases |
| `Adj17_triangle_free` | **Admitted** | Main theorem uses 4913 tf_x_y_z lemmas |
| `Adj17_not_indep_*` (12376 subsets) | **Generated** | 198K lines, each 6-subset has edge |
| `Adj17_no_6_indep` | **Structure done** | Uses cases axiom + 12376 lemmas |
| `lower_bound` | **Kernel verified** | Uses admitted helper lemmas |
| `triangle_free_no_3clique` | Admitted | Helper: triangle_free => no 3-clique |
| `no_k_indep_no_indep_set` | Admitted | Helper: no_k_indep => no k-indep set |
| `upper_bound` | **Proof done** | Uses xm + helper lemmas |
| `Ramsey_3_6_eq_18` | Compiles | Uses bounds |

## Files

### Proof Files
- `ramsey36_mizar.mg` - Main proof file (Mizar theory)
- `lower_bound_proof.mg` - Kernel-verified lower_bound proof structure
- `upper_bound_proof.mg` - Upper bound proof with classical logic (xm, dneg)
- `adj17_with_sym.mg` - Kernel-verified Adj17_sym proof (2572 lines)
- `adj17_all_proofs.mg` - Combined proofs: sym + neq + non-edges + paths (30554 lines)
- `adj17_nonedge_proofs.mg` - Non-edge and path lemma proofs
- `adj17_selfloop_and_nonedge_proofs.mg` - Self-loops + non-edges + paths (~30K lines)
- `adj17_triangle_free_proof.mg` - 4913 tf_x_y_z case lemmas (~25K lines)
- `adj17_no6indep_proof.mg` - 12376 subset lemmas + main theorem (~198K lines)
- `neq_lemmas.mg` - Additional inequality lemmas for 10-16
- `cases17_axiom.mg` - Case analysis axioms for ordinals 10-18

### Generators
- `gen_adj17_proofs.py` - Original proof generator (edge theorems)
- `gen_adj17_nonedge_proofs.py` - Proof generator for non-edges, paths, self-loops
- `gen_adj17_triangle_free.py` - Generates tf_x_y_z case lemmas (4913 cases)
- `gen_adj17_no6indep_kernel.py` - Full kernel proof generator for no_6_indep
- `gen_adj17_no6indep.py` - Analysis script for 6-independence verification

## ATP Verification Results

### Adj17_no_6_indep (No 6-vertex independent set)

TPTP file: `/tmp/adj17_no6indep_v3.p`

```
% Vampire 5.0.0
% SZS status Theorem for adj17_no6indep_v3
% Refutation found in ~7 seconds (CASC mode)
```

The graph has:
- 17 vertices (0-16)
- 40 undirected edges (80 directed)
- Maximum independent set size: 5 (82 such sets)
- All 12,376 6-subsets have at least one edge

### Adj17_triangle_free (No triangles)

Verified computationally:
- 316 two-edge paths x→y→z
- 0 triangles (verified by exhaustive check)

## Build Instructions

```bash
cd megalodon
./bin/megalodon -mizar -I examples/mizar/PfgMizarNov2020Preamble.mgs ramsey36/ramsey36_mizar.mg
```

## Theory

Uses Mizar theory (`-mizar` flag) with the Proofgold November 2020 preamble.

Key definitions from the preamble:
- `neq_n_m` axioms for 0-9
- `ordsucc_inj_contra` for generating larger inequalities
- `In_irref`, `In_no2cycle` for ordinal reasoning

## Reconstruction Status

### Adj17_triangle_free (17³ = 4913 cases) - DONE

The `cases_17` axiom has been added to `cases17_axiom.mg`. Individual case lemmas `tf_x_y_z` are generated by `gen_adj17_triangle_free.py` and stored in `adj17_triangle_free_proof.mg` (~25K lines).

Case breakdown:
- Self-loop cases (x=y or y=z or x=z): 833 (trivial by reflexivity contradiction)
- H1 contradiction (x-y not edge): 2850 cases
- H2 contradiction (y-z not edge): 914 cases
- H3 contradiction (x-z not edge): 316 cases (use path lemmas)

### Adj17_no_6_indep (12,376 6-subsets) - DONE

Full kernel proof generated by `gen_adj17_no6indep_kernel.py`:
- 12,376 individual lemmas proving each 6-subset contains an edge
- Each lemma uses set membership proofs via `binunionI1/I2`, `SingI`, `UPairI1/I2`
- Case analysis axiom `subsets_6_17_cases` connects individual lemmas to main theorem
- Total: ~198K lines in `adj17_no6indep_proof.mg`

## Upper Bound Proof Structure

The upper bound R(3,6) ≤ 18 is now proved in `upper_bound_proof.mg` using classical logic:

```
Theorem upper_bound : TwoRamseyProp 3 6 18.
```

The proof uses excluded middle (`xm`) and double negation elimination (`dneg`):
1. For any symmetric relation R on 18:
2. Either R is triangle-free or not (by `xm`)
3. If not triangle-free: extract 3-clique witness via `triangle_witness_from_neg`
4. If triangle-free: either no_k_indep 18 R 6 or not (by `xm`)
5. If both triangle-free and no_k_indep: contradiction via `good_graph_contradiction`
6. If not no_k_indep: extract 6-indep set via `indep_witness_from_neg`

### Remaining Helper Lemmas (Admitted)

1. `triangle_witness_from_neg` - Convert ~triangle_free to 3-clique existence
2. `indep_witness_from_neg` - Convert ~no_k_indep to k-indep set existence
3. `good_graph_contradiction` - No symmetric R on 18 can be both triangle-free and have no 6-indep set

The `good_graph_contradiction` is the core mathematical result requiring:
- Formalization of degree counting
- Case analysis for triangle-free graphs with bounded independent sets

## References

- Cariolaro, D. "On the Ramsey number R(3,6)". Australian J. Combinatorics 37 (2007), 301-305.
- Graver, J.E. & Yackel, J. "Some graph theoretic results associated with Ramsey's theorem". J. Comb. Theory 4 (1968), 125-175.
